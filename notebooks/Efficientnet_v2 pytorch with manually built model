{"cells":[{"cell_type":"markdown","metadata":{"id":"GG8n8JkZT_mE"},"source":["# Load package"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":128959,"status":"ok","timestamp":1680792647375,"user":{"displayName":"杨思哲","userId":"09738222916716147105"},"user_tz":-480},"id":"2Wh4t_qrT9ot","outputId":"b9cd139e-acf7-4e41-f780-d1174501d0c5"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n","import os\n","os.chdir('/content/drive/My Drive/DSA5204/Project/ysz')\n","# from model import efficientnet"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10652,"status":"ok","timestamp":1680792658019,"user":{"displayName":"杨思哲","userId":"09738222916716147105"},"user_tz":-480},"id":"KVWY3T_uKPU6","outputId":"9c10c121-7524-407c-ec46-7378c0eed639"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting xlwt\n","  Downloading xlwt-1.3.0-py2.py3-none-any.whl (99 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m100.0/100.0 KB\u001b[0m \u001b[31m12.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: xlwt\n","Successfully installed xlwt-1.3.0\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting ptflops\n","  Downloading ptflops-0.6.9.tar.gz (12 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: torch in /usr/local/lib/python3.9/dist-packages (from ptflops) (2.0.0+cu118)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (2.0.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (1.11.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (4.5.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (3.10.7)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (3.0)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.9/dist-packages (from torch->ptflops) (3.1.2)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.9/dist-packages (from triton==2.0.0->torch->ptflops) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.9/dist-packages (from triton==2.0.0->torch->ptflops) (16.0.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.9/dist-packages (from jinja2->torch->ptflops) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.9/dist-packages (from sympy->torch->ptflops) (1.3.0)\n","Building wheels for collected packages: ptflops\n","  Building wheel for ptflops (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for ptflops: filename=ptflops-0.6.9-py3-none-any.whl size=11711 sha256=8c1cc2977011c30cf8f8dfaae74b791308e0a16d62babc29c05eb97e25778440\n","  Stored in directory: /root/.cache/pip/wheels/86/07/9f/879035d99d7b639bbc564d23fed862a679aee7d1a2dced8c2e\n","Successfully built ptflops\n","Installing collected packages: ptflops\n","Successfully installed ptflops-0.6.9\n"]}],"source":["!pip install xlwt\n","!pip install ptflops"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"bj_8Z70-TY_g","executionInfo":{"status":"ok","timestamp":1680792662402,"user_tz":-480,"elapsed":4394,"user":{"displayName":"杨思哲","userId":"09738222916716147105"}}},"outputs":[],"source":["import torchvision\n","import os\n","import function\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","from torchvision import transforms\n","from torchvision import models\n","from torch.utils.data import Dataset\n","from tqdm import tqdm\n","import copy"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1680792662910,"user":{"displayName":"杨思哲","userId":"09738222916716147105"},"user_tz":-480},"id":"lK6RjYFdTln-","outputId":"615ded37-fed2-458a-b449-5ff07f9dccf9"},"outputs":[{"output_type":"stream","name":"stdout","text":["using cuda:0 device.\n"]}],"source":["device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","print(\"using {} device.\".format(device))"]},{"cell_type":"markdown","metadata":{"id":"l1JD3EfLUFw_"},"source":["# Load Dataset\n","## For this experiment, we only use \"dog\" and \"cat\" classes in dataset Cifar-10 as a demo."]},{"cell_type":"code","execution_count":5,"metadata":{"id":"u1XUkfsSRuhz","executionInfo":{"status":"ok","timestamp":1680792662911,"user_tz":-480,"elapsed":5,"user":{"displayName":"杨思哲","userId":"09738222916716147105"}}},"outputs":[],"source":["img_size = {\"B0\": 224, \"B1\": 240, \"B2\": 260, \"B3\": 300, \"B4\": 380, \"B5\": 456, \"B6\": 528, \"B7\": 600, \"customized\":336}\n","num_model = \"B0\""]},{"cell_type":"code","execution_count":6,"metadata":{"id":"ETL11GNfUgBM","executionInfo":{"status":"ok","timestamp":1680792662911,"user_tz":-480,"elapsed":5,"user":{"displayName":"杨思哲","userId":"09738222916716147105"}}},"outputs":[],"source":["data_transform = {\"train\": transforms.Compose([transforms.RandomResizedCrop(img_size[num_model]),\n","                         transforms.RandomRotation(degrees=(-15, 15)),                      \n","                         transforms.RandomHorizontalFlip(p = 0.5), # Random flip in horizontal direction, with p = 0.5 by default\n","                         transforms.ToTensor(),\n","                         transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010))\n","          ]),\n"," \n","          \"val\": transforms.Compose([transforms.Resize(img_size[num_model]),\n","                        transforms.ToTensor(),\n","                        transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010))\n","          ])}"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19915,"status":"ok","timestamp":1680792682822,"user":{"displayName":"杨思哲","userId":"09738222916716147105"},"user_tz":-480},"id":"hcvPQBb2g1I_","outputId":"4facd411-963a-4de0-c485-9a8d9f8c8553"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz to ./data/CIFAR10/cifar-100-python.tar.gz\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 169001437/169001437 [00:12<00:00, 13110464.46it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Extracting ./data/CIFAR10/cifar-100-python.tar.gz to ./data/CIFAR10\n"]}],"source":["train_dataset = torchvision.datasets.CIFAR100(root='./data/CIFAR10', train=True, download=True, transform=data_transform[\"train\"])\n","val_dataset = torchvision.datasets.CIFAR100(root='./data/CIFAR10', train=False, download=False, transform=data_transform[\"val\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H9U1b6ELeFIw"},"outputs":[],"source":["epochs = 100\n","save_model = '/content/drive/My Drive/DSA5204/best_model.pth'\n","save_path = '/content/drive/My Drive/DSA5204/'\n","batch_size = 64\n","num_classes = 10"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1680523890530,"user":{"displayName":"杨思哲","userId":"09738222916716147105"},"user_tz":-480},"id":"fMb05_m8VEBT","outputId":"955c12fb-bdd7-415b-a1cf-12a3d80894b4"},"outputs":[{"name":"stdout","output_type":"stream","text":["using 50000 images for training, 10000 images for validation.\n","Using 8 dataloader workers every process\n"]}],"source":["train_num = len(train_dataset)\n","val_num = len(val_dataset)\n","print(\"using {} images for training, {} images for validation.\".format(train_num, val_num))\n","\n","nw = min([os.cpu_count(), batch_size if batch_size > 1 else 0, 8])  # number of workers\n","print('Using {} dataloader workers every process'.format(nw))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n0XxYEVyVZFq"},"outputs":[],"source":["train_loader = torch.utils.data.DataLoader(train_dataset, \n","                       batch_size=batch_size,\n","                       shuffle=True,\n","                       pin_memory=True,\n","                       num_workers=nw)\n"," \n","val_loader = torch.utils.data.DataLoader(val_dataset,\n","                      batch_size=batch_size,\n","                      shuffle=False,\n","                      pin_memory=True,\n","                      num_workers=nw)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"veEvKdCCTLOW"},"outputs":[],"source":["model_v2 = models.efficientnet_v2_s().to(device)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"K9i2HNkhVuCT"},"outputs":[],"source":["loss_function = nn.CrossEntropyLoss()\n","optimizer = optim.Adam(model_v2.parameters(), lr=0.001)\n","best_acc = 0.0\n","train_acc_list = []\n","train_loss_list = []\n","val_acc_list = []"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cIUJYkmAV9AG","executionInfo":{"status":"ok","timestamp":1680583920049,"user_tz":-480,"elapsed":6408322,"user":{"displayName":"杨思哲","userId":"09738222916716147105"}},"outputId":"8920d240-1500-4eae-fdcf-db6effff414d"},"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:35<00:00,  1.36it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 1] train_loss: 0.0306328  train_accuracy: 0.281\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 1] val_accuracy: 0.414\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 2] train_loss: 0.0262966  train_accuracy: 0.386\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 2] val_accuracy: 0.479\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 3] train_loss: 0.0231373  train_accuracy: 0.466\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.31it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 3] val_accuracy: 0.593\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 4] train_loss: 0.0206422  train_accuracy: 0.529\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 4] val_accuracy: 0.608\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 5] train_loss: 0.0189180  train_accuracy: 0.571\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 5] val_accuracy: 0.668\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 6] train_loss: 0.0175707  train_accuracy: 0.604\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 6] val_accuracy: 0.718\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 7] train_loss: 0.0163363  train_accuracy: 0.632\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 7] val_accuracy: 0.737\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 8] train_loss: 0.0154451  train_accuracy: 0.654\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 8] val_accuracy: 0.761\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 9] train_loss: 0.0146027  train_accuracy: 0.674\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 9] val_accuracy: 0.784\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 10] train_loss: 0.0138765  train_accuracy: 0.691\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 10] val_accuracy: 0.797\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 11] train_loss: 0.0133859  train_accuracy: 0.703\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 11] val_accuracy: 0.808\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 12] train_loss: 0.0128899  train_accuracy: 0.715\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 12] val_accuracy: 0.828\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 13] train_loss: 0.0124208  train_accuracy: 0.726\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 13] val_accuracy: 0.828\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 14] train_loss: 0.0121041  train_accuracy: 0.731\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 14] val_accuracy: 0.831\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 15] train_loss: 0.0117158  train_accuracy: 0.741\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 15] val_accuracy: 0.850\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 16] train_loss: 0.0112775  train_accuracy: 0.749\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 16] val_accuracy: 0.840\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 17] train_loss: 0.0111384  train_accuracy: 0.753\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 17] val_accuracy: 0.853\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 18] train_loss: 0.0107351  train_accuracy: 0.762\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 18] val_accuracy: 0.862\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 19] train_loss: 0.0104726  train_accuracy: 0.768\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 19] val_accuracy: 0.872\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 20] train_loss: 0.0103523  train_accuracy: 0.770\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 20] val_accuracy: 0.868\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 21] train_loss: 0.0101196  train_accuracy: 0.774\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 21] val_accuracy: 0.870\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 22] train_loss: 0.0098791  train_accuracy: 0.780\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 22] val_accuracy: 0.874\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 23] train_loss: 0.0097011  train_accuracy: 0.786\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 23] val_accuracy: 0.884\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 24] train_loss: 0.0094732  train_accuracy: 0.789\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.31it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 24] val_accuracy: 0.870\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 25] train_loss: 0.0093344  train_accuracy: 0.792\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 25] val_accuracy: 0.881\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 26] train_loss: 0.0091362  train_accuracy: 0.797\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 26] val_accuracy: 0.884\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 27] train_loss: 0.0089408  train_accuracy: 0.801\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 27] val_accuracy: 0.890\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 28] train_loss: 0.0088149  train_accuracy: 0.807\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 28] val_accuracy: 0.889\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 29] train_loss: 0.0087162  train_accuracy: 0.808\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 29] val_accuracy: 0.883\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 30] train_loss: 0.0085561  train_accuracy: 0.811\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 30] val_accuracy: 0.897\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 31] train_loss: 0.0083776  train_accuracy: 0.815\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 31] val_accuracy: 0.895\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 32] train_loss: 0.0082042  train_accuracy: 0.817\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 32] val_accuracy: 0.896\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 33] train_loss: 0.0082036  train_accuracy: 0.820\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 33] val_accuracy: 0.886\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 34] train_loss: 0.0081145  train_accuracy: 0.821\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 34] val_accuracy: 0.893\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 35] train_loss: 0.0079906  train_accuracy: 0.824\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 35] val_accuracy: 0.901\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 36] train_loss: 0.0078360  train_accuracy: 0.828\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 36] val_accuracy: 0.906\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 37] train_loss: 0.0077703  train_accuracy: 0.827\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 37] val_accuracy: 0.898\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 38] train_loss: 0.0077296  train_accuracy: 0.829\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 38] val_accuracy: 0.902\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 39] train_loss: 0.0076153  train_accuracy: 0.833\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 39] val_accuracy: 0.910\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 40] train_loss: 0.0074465  train_accuracy: 0.834\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 40] val_accuracy: 0.910\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 41] train_loss: 0.0073262  train_accuracy: 0.838\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 41] val_accuracy: 0.905\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 42] train_loss: 0.0072234  train_accuracy: 0.840\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 42] val_accuracy: 0.907\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 43] train_loss: 0.0073176  train_accuracy: 0.838\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 43] val_accuracy: 0.904\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 44] train_loss: 0.0071879  train_accuracy: 0.841\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 44] val_accuracy: 0.908\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 45] train_loss: 0.0070193  train_accuracy: 0.845\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 45] val_accuracy: 0.913\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 46] train_loss: 0.0069306  train_accuracy: 0.845\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 46] val_accuracy: 0.910\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 47] train_loss: 0.0069918  train_accuracy: 0.845\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 47] val_accuracy: 0.910\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 48] train_loss: 0.0068728  train_accuracy: 0.848\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 48] val_accuracy: 0.911\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 49] train_loss: 0.0067169  train_accuracy: 0.851\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 49] val_accuracy: 0.910\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 50] train_loss: 0.0066945  train_accuracy: 0.852\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 50] val_accuracy: 0.913\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 51] train_loss: 0.0066512  train_accuracy: 0.853\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 51] val_accuracy: 0.918\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 52] train_loss: 0.0065649  train_accuracy: 0.854\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 52] val_accuracy: 0.916\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 53] train_loss: 0.0065209  train_accuracy: 0.856\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 53] val_accuracy: 0.909\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 54] train_loss: 0.0064814  train_accuracy: 0.855\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 54] val_accuracy: 0.917\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 55] train_loss: 0.0063901  train_accuracy: 0.859\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 55] val_accuracy: 0.916\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 56] train_loss: 0.0064174  train_accuracy: 0.857\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 56] val_accuracy: 0.920\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 57] train_loss: 0.0062730  train_accuracy: 0.861\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 57] val_accuracy: 0.922\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 58] train_loss: 0.0062058  train_accuracy: 0.863\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 58] val_accuracy: 0.919\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 59] train_loss: 0.0061838  train_accuracy: 0.863\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 59] val_accuracy: 0.920\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 60] train_loss: 0.0062113  train_accuracy: 0.861\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 60] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 61] train_loss: 0.0061886  train_accuracy: 0.864\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 61] val_accuracy: 0.918\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 62] train_loss: 0.0060943  train_accuracy: 0.865\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 62] val_accuracy: 0.920\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 63] train_loss: 0.0060384  train_accuracy: 0.867\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 63] val_accuracy: 0.918\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 64] train_loss: 0.0059801  train_accuracy: 0.868\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 64] val_accuracy: 0.913\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 65] train_loss: 0.0059096  train_accuracy: 0.868\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 65] val_accuracy: 0.914\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 66] train_loss: 0.0058489  train_accuracy: 0.869\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 66] val_accuracy: 0.921\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 67] train_loss: 0.0058741  train_accuracy: 0.869\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 67] val_accuracy: 0.925\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 68] train_loss: 0.0057864  train_accuracy: 0.872\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 68] val_accuracy: 0.919\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 69] train_loss: 0.0058205  train_accuracy: 0.871\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.25it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 69] val_accuracy: 0.921\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 70] train_loss: 0.0057215  train_accuracy: 0.874\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 70] val_accuracy: 0.921\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 71] train_loss: 0.0057383  train_accuracy: 0.872\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 71] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 72] train_loss: 0.0056173  train_accuracy: 0.876\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 72] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 73] train_loss: 0.0056483  train_accuracy: 0.875\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 73] val_accuracy: 0.924\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 74] train_loss: 0.0055819  train_accuracy: 0.877\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 74] val_accuracy: 0.918\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 75] train_loss: 0.0055289  train_accuracy: 0.878\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 75] val_accuracy: 0.918\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 76] train_loss: 0.0055523  train_accuracy: 0.878\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 76] val_accuracy: 0.926\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 77] train_loss: 0.0054474  train_accuracy: 0.880\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 77] val_accuracy: 0.928\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 78] train_loss: 0.0054721  train_accuracy: 0.879\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 78] val_accuracy: 0.924\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 79] train_loss: 0.0054427  train_accuracy: 0.880\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 79] val_accuracy: 0.924\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 80] train_loss: 0.0053609  train_accuracy: 0.882\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 80] val_accuracy: 0.925\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 81] train_loss: 0.0054255  train_accuracy: 0.881\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 81] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 82] train_loss: 0.0052638  train_accuracy: 0.883\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 82] val_accuracy: 0.922\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 83] train_loss: 0.0052351  train_accuracy: 0.884\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 83] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 84] train_loss: 0.0052791  train_accuracy: 0.883\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.26it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 84] val_accuracy: 0.927\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 85] train_loss: 0.0052268  train_accuracy: 0.886\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 85] val_accuracy: 0.928\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 86] train_loss: 0.0051733  train_accuracy: 0.887\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 86] val_accuracy: 0.930\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 87] train_loss: 0.0051402  train_accuracy: 0.888\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.27it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 87] val_accuracy: 0.923\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 88] train_loss: 0.0051512  train_accuracy: 0.885\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 88] val_accuracy: 0.928\n","save success!   .\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 89] train_loss: 0.0050572  train_accuracy: 0.889\n"]},{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["[epoch 89] val_accuracy: 0.925\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 90] train_loss: 0.0050834  train_accuracy: 0.888\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 90] val_accuracy: 0.926\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 91] train_loss: 0.0050628  train_accuracy: 0.888\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 91] val_accuracy: 0.925\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 92] train_loss: 0.0049729  train_accuracy: 0.890\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 92] val_accuracy: 0.925\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:30<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 93] train_loss: 0.0050039  train_accuracy: 0.889\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 93] val_accuracy: 0.928\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 94] train_loss: 0.0050139  train_accuracy: 0.889\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 94] val_accuracy: 0.928\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 95] train_loss: 0.0048766  train_accuracy: 0.894\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 95] val_accuracy: 0.930\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 96] train_loss: 0.0049107  train_accuracy: 0.891\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 96] val_accuracy: 0.920\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 97] train_loss: 0.0048860  train_accuracy: 0.892\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.30it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 97] val_accuracy: 0.923\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 98] train_loss: 0.0049515  train_accuracy: 0.891\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 98] val_accuracy: 0.928\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 99] train_loss: 0.0048133  train_accuracy: 0.894\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.29it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 99] val_accuracy: 0.928\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 782/782 [09:29<00:00,  1.37it/s]\n"]},{"output_type":"stream","name":"stdout","text":["[epoch 100] train_loss: 0.0048357  train_accuracy: 0.893\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 157/157 [00:29<00:00,  5.28it/s]"]},{"output_type":"stream","name":"stdout","text":["[epoch 100] val_accuracy: 0.929\n","save success!   .\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["for epoch in range(epochs):\n","  # train\n","  model_v2.train()\n","  running_loss_train = 0.0\n","  train_accurate = 0.0\n","  train_bar = tqdm(train_loader) # visualize the training progress\n","  for images, labels in train_bar:\n","    optimizer.zero_grad()\n","    outputs = model_v2(images.to(device))\n","    loss = loss_function(outputs, labels.to(device))\n","    loss.backward()\n","    optimizer.step()\n","\n","    predict = torch.max(outputs, dim=1)[1]\n","    train_accurate += torch.eq(predict, labels.to(device)).sum().item()\n","    running_loss_train += loss.item()\n","  \n","  train_accurate = train_accurate / train_num\n","  running_loss_train = running_loss_train / train_num\n","  train_acc_list.append(train_accurate)\n","  train_loss_list.append(running_loss_train)\n"," \n","  print('[epoch %d] train_loss: %.7f  train_accuracy: %.3f' %(epoch + 1, running_loss_train, train_accurate))\n","\n","\n","  # validate\n","  model_v2.eval()\n","  acc = 0.0  # accumulate accurate number / epoch\n","  with torch.no_grad():\n","    val_loader = tqdm(val_loader)\n","    for val_data in val_loader:\n","      val_images, val_labels = val_data\n","      outputs = model_v2(val_images.to(device))\n","      predict_y = torch.max(outputs.float(), dim=1)[1]\n","      acc += torch.eq(predict_y, val_labels.to(device)).sum().item()\n","  val_accurate = acc / val_num\n","  val_acc_list.append(val_accurate)\n","  print('[epoch %d] val_accuracy: %.3f' %(epoch + 1, val_accurate))\n","  function.writer_into_excel_onlyval(save_path, train_loss_list, train_acc_list, val_acc_list, None, \"CIFAR-10\")\n","\n","  # Save the best model based on acc\n","  if val_accurate > best_acc:\n","    best_acc = val_accurate\n","    torch.save(model_v2.state_dict(), save_model)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KZ-6mbPNRxlT"},"outputs":[],"source":["from ptflops import get_model_complexity_info"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H_6qC4NoJKkO"},"outputs":[],"source":["macs, params = get_model_complexity_info(model_v2, (3, 224, 224), as_strings=True,\n","                      print_per_layer_stat=True, verbose=True)\n","print('{:<30}  {:<8}'.format('Computational complexity: ', macs))\n","print('{:<30}  {:<8}'.format('Number of parameters: ', params))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F9pmuzUTKByH"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1slCNVPef5udM3UY4ysY7W4-k5jiE4Nu0","timestamp":1680523022995}],"toc_visible":true},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}